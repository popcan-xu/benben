<!DOCTYPE html>
{% extends 'dashboard/base_dashboard.html' %}
{% block page_content %}
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŠ•èµ„ç»„åˆæŠ•èµ„ç»„åˆå¯è§†åŒ–åˆ†æ</title>
{#    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>#}
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            min-height: 100vh;
            padding: 20px;
            color: #343a40;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .header p {
            color: #6c757d;
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .chart-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .chart-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
        }

        .card-header {
            background: linear-gradient(135deg, #4c6ef5 0%, #3b5bdb 100%);
            color: white;
            padding: 18px 25px;
            font-size: 1.3rem;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-header .card-info {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .chart-container {
            height: 400px;
            width: 100%;
            padding: 15px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.06);
            padding: 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        .stat-value {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: #4c6ef5;
        }

        .stat-label {
            font-size: 1.1rem;
            color: #6c757d;
        }

        .stat-detail {
            margin-top: 15px;
            font-size: 0.95rem;
            color: #495057;
            line-height: 1.6;
        }

        .footer {
            text-align: center;
            padding: 25px;
            color: #6c757d;
            font-size: 0.9rem;
            border-top: 1px solid #e9ecef;
            margin-top: 20px;
        }

        /* è¡¨æ ¼æ ·å¼ */
        .table-container {
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .data-table th {
            background-color: #f1f3f9;
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
            color: #495057;
            position: sticky;
            top: 0;
        }

        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e9ecef;
            color: #495057;
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        .data-table tr:hover {
            background-color: #f8f9fa;
        }

        .buy-cell {
            color: #e64980;
            font-weight: 600;
        }

        .sell-cell {
            color: #40c057;
            font-weight: 600;
        }

        .dividend-cell {
            color: #228be6;
            font-weight: 600;
        }

        .table-title {
            margin-bottom: 15px;
            font-size: 1.1rem;
            color: #495057;
            font-weight: 600;
            display: flex;
            align-items: center;
        }

        .table-title i {
            margin-right: 10px;
            font-size: 1.2rem;
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }

            .chart-container {
                height: 350px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .data-table {
                font-size: 0.85rem;
            }

            .data-table th, .data-table td {
                padding: 8px 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>æŠ•èµ„ç»„åˆæŠ•èµ„ç»„åˆå¯è§†åŒ–åˆ†æ</h1>
            <p>å…¨é¢å±•ç¤ºæŠ•èµ„ç»„åˆæŠ•èµ„ç»„åˆåˆ†å¸ƒã€æŒä»“ç»“æ„ã€äº¤æ˜“è®°å½•å’Œåˆ†çº¢æƒ…å†µ</p>
        </div>

        <!-- å…³é”®æŒ‡æ ‡å¡ç‰‡ -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon" style="background: rgba(76, 110, 245, 0.15); color: #4c6ef5;">
                    ï¿¥
                </div>
                <div class="stat-value">3,371.84ä¸‡</div>
                <div class="stat-label">æŠ•èµ„ç»„åˆæ€»å€¼</div>
                <div class="stat-detail">å‡€å€¼æƒé‡: 3.72%</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon" style="background: rgba(40, 167, 69, 0.15); color: #28a745;">
                    â†‘
                </div>
                <div class="stat-value">3,358.29ä¸‡</div>
                <div class="stat-label">å¸‚å€¼æ€»å’Œ</div>
                <div class="stat-detail">ä»“ä½æƒé‡: 86.65%</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon" style="background: rgba(255, 193, 7, 0.15); color: #ffc107;">
                    $
                </div>
                <div class="stat-value">909.70ä¸‡</div>
                <div class="stat-label">ç´¯è®¡åˆ†çº¢</div>
                <div class="stat-detail">å½“å¹´åˆ†çº¢: 39.75ä¸‡</div>
            </div>

            <div class="stat-card">
                <div class="stat-icon" style="background: rgba(220, 53, 69, 0.15); color: #dc3545;">
                    âš¡
                </div>
                <div class="stat-value">176.89ä¸‡</div>
                <div class="stat-label">ç”³è´­æ€»é¢</div>
                <div class="stat-detail">è‚¡ç¥¨æ•°: 186 | å€ºåˆ¸æ•°: 386</div>
            </div>
        </div>

        <!-- å›¾è¡¨å¡ç‰‡ -->
        <div class="dashboard">
            <!-- æŠ•èµ„ç»„åˆæŠ•èµ„ç»„åˆåˆ†å¸ƒ -->
            <div class="chart-card">
                <div class="card-header">
                    <span>æŠ•èµ„ç»„åˆæŠ•èµ„ç»„åˆåˆ†å¸ƒ</span>
                    <span class="card-info">å¸ç§å æ¯”</span>
                </div>
                <div class="chart-container" id="portfolioDistributionChart"></div>
            </div>

            <!-- æŒä»“è‚¡ç¥¨å¸‚å€¼å æ¯” -->
            <div class="chart-card">
                <div class="card-header">
                    <span>æŒä»“è‚¡ç¥¨å¸‚å€¼å æ¯”</span>
                    <span class="card-info">å‰äº”å¤§æŒä»“å æ¯”96.86%</span>
                </div>
                <div class="chart-container" id="holdingChart"></div>
            </div>

            <!-- å¸‚åœºåˆ†å¸ƒ -->
            <div class="chart-card">
                <div class="card-header">
                    <span>å¸‚åœºåˆ†å¸ƒ</span>
                    <span class="card-info">ä¸åŒå¸‚åœºå¸‚å€¼å æ¯”</span>
                </div>
                <div class="chart-container" id="marketDistributionChart"></div>
            </div>

            <!-- æŒä»“è‚¡ç¥¨å¸‚å€¼ -->
            <div class="chart-card">
                <div class="card-header">
                    <span>æŒä»“è‚¡ç¥¨å¸‚å€¼</span>
                    <span class="card-info">18åªæŒä»“è‚¡ç¥¨</span>
                </div>
                <div class="chart-container" id="stockValueChart"></div>
            </div>

            <!-- åˆ†çº¢è®°å½•è¡¨æ ¼ -->
            <div class="chart-card">
                <div class="card-header">
                    <span>åˆ†çº¢è®°å½•</span>
                    <span class="card-info">æœ€è¿‘5ç¬”åˆ†çº¢</span>
                </div>
                <div class="table-container">
                    <div class="table-title">
                        <i>ğŸ“…</i> åˆ†çº¢æ˜ç»†è®°å½•
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>æ—¥æœŸ</th>
                                <th>è‚¡ç¥¨åç§°</th>
                                <th>é‡‘é¢(å…ƒ)</th>
                                <th>è´¦æˆ·</th>
                            </tr>
                        </thead>
                        <tbody id="dividendTableBody">
                            <!-- åˆ†çº¢æ•°æ®å°†é€šè¿‡JSå¡«å…… -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- äº¤æ˜“è®°å½•è¡¨æ ¼ -->
            <div class="chart-card">
                <div class="card-header">
                    <span>äº¤æ˜“è®°å½•</span>
                    <span class="card-info">æœ€è¿‘5ç¬”äº¤æ˜“</span>
                </div>
                <div class="table-container">
                    <div class="table-title">
                        <i>ğŸ“Š</i> äº¤æ˜“æ˜ç»†è®°å½•
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>æ—¥æœŸ</th>
                                <th>è‚¡ç¥¨åç§°</th>
                                <th>æ“ä½œ</th>
                                <th>ä»·æ ¼</th>
                                <th>æ•°é‡</th>
                                <th>é‡‘é¢(å…ƒ)</th>
                            </tr>
                        </thead>
                        <tbody id="tradeTableBody">
                            <!-- äº¤æ˜“æ•°æ®å°†é€šè¿‡JSå¡«å…… -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="footer">
            æ•°æ®æ›´æ–°æ—¶é—´: 2025-08-15 16:10:57 | å¯è§†åŒ–åˆ†æç³»ç»Ÿ v2.0
        </div>
    </div>

    <script>
        // æŠ•èµ„ç»„åˆæ•°æ®
        const portfolioData = {
            portfolio_value_sum: 33718359,
            portfolio_net_value_weighting: 3.7233344477203056,
            market_value_sum: 33582919.45144001,
            position_percent_weighting: 0.8665471400742888,
            dividend_sum: 9097028.839970998,
            current_dividend_sum: 397472.5767,
            current_dividend_percent: 1.1835557574877746,
            subscription_sum: 1768852.05,
            subscription_stock_num: 186,
            subscription_band_num: 386,
            current_subscription_sum: 27185.0,
            current_subscription_stock_num: 2,
            current_subscription_band_num: 0,
            holding_stock_number: 18,
            portfolio_value_array: [29561213, 2503752, 1653394],
            portfolio_principal_array: [20000000, 2196649, 1436560],
            portfolio_currency_array: ["äººæ°‘å¸", "æ¸¯å…ƒ", "ç¾å…ƒ"],
            holding_stock_array: [
                ["è…¾è®¯æ§è‚¡ï¼ˆ00700ï¼‰", 592.0, 0.0034000000000000002, "#ef4444", 33900, 18445234.080000002, "54.92%", 35],
                ["è´µå·èŒ…å°ï¼ˆ600519ï¼‰", 1422.08, -0.0034000000000000002, "#10b981", 7000, 9954560.0, "29.64%", 26],
                ["é“¶åæ—¥åˆ©ETFï¼ˆ511880ï¼‰", 100.801, 0.0001, "#ef4444", 31500, 3175231.5, "9.45%", 93],
                ["åˆ†ä¼—ä¼ åª’ï¼ˆ002027ï¼‰", 8.02, 0.005, "#ef4444", 81400, 652828.0, "1.94%", 24],
                ["å¤§å…¨æ–°èƒ½æºï¼ˆDQï¼‰", 21.26, -0.0248, "#10b981", 2000, 305412.656, "0.91%", 94],
                ["æ‹¼å¤šå¤šï¼ˆPDDï¼‰", 114.74, -0.016200000000000003, "#10b981", 220, 181313.98384, "0.54%", 95],
                ["ä¸­å›½å¹³å®‰ï¼ˆ601318ï¼‰", 59.8, 0.003, "#ef4444", 2400, 143520.0, "0.43%", 2],
                ["H&Hå›½é™…æ§è‚¡ï¼ˆ01112ï¼‰", 13.13, 0.0718, "#ef4444", 11000, 132745.613, "0.40%", 13],
                ["ä¸­å›½å®æ¡¥ï¼ˆ01378ï¼‰", 23.38, 0.0447, "#ef4444", 5500, 118187.069, "0.35%", 10],
                ["å¤äº•è´¡Bï¼ˆ200596ï¼‰", 106.43, -0.0023, "#10b981", 1200, 117383.77560000002, "0.35%", 48],
                ["ç¦è€€ç»ç’ƒï¼ˆ600660ï¼‰", 55.6, 0.0004, "#ef4444", 2000, 111200.0, "0.33%", 14],
                ["ä¸­ä¿¡é“¶è¡Œï¼ˆ00998ï¼‰", 7.27, -0.0176, "#10b981", 12000, 80182.284, "0.24%", 17],
                ["ä¸­å›½å¤ªå¹³ï¼ˆ00966ï¼‰", 18.89, 0.0096, "#ef4444", 3000, 52085.397000000004, "0.16%", 21],
                ["æ–°åä¿é™©ï¼ˆ01336ï¼‰", 52.3, 0.0275, "#ef4444", 900, 43262.037000000004, "0.13%", 16],
                ["ä¿åˆ©åé‘«èƒ½æºï¼ˆ03800ï¼‰", 1.25, 0.087, "#ef4444", 30000, 34466.25, "0.10%", 15],
                ["æƒ ç†é›†å›¢ï¼ˆ00806ï¼‰", 2.44, 0.0252, "#ef4444", 8000, 17940.832000000002, "0.05%", 18],
                ["é‡‘è³è‚ï¼ˆ002081ï¼‰", 3.62, 0.0, "#6b7280", 4000, 14480.0, "0.04%", 23],
                ["ä¸­å›½é‡‘èŒ‚ï¼ˆ00817ï¼‰", 1.57, 0.0129, "#ef4444", 2000, 2885.974, "0.01%", 22]
            ],
            top5_percent: 96.86,
            top5_array: [
                ["è…¾è®¯æ§è‚¡ï¼ˆ00700ï¼‰", 18445234.080000002, "54.92%", "primary", 35],
                ["è´µå·èŒ…å°ï¼ˆ600519ï¼‰", 9954560.0, "29.64%", "secondary", 26],
                ["é“¶åæ—¥åˆ©ETFï¼ˆ511880ï¼‰", 3175231.5, "9.45%", "success", 93],
                ["åˆ†ä¼—ä¼ åª’ï¼ˆ002027ï¼‰", 652828.0, "1.94%", "info", 24],
                ["å¤§å…¨æ–°èƒ½æºï¼ˆDQï¼‰", 305412.656, "0.91%", "warning", 94]
            ],
            market_name_array: "[\"æ¸¯è‚¡\", \"æ²ªå¸‚Aè‚¡\", \"æ·±å¸‚Aè‚¡\", \"ç¾è‚¡\", \"æ·±å¸‚Bè‚¡\"]",
            market_value_array: [18926989, 13384511, 667308, 486726, 117383],
            trade_array: [
                ["2025-08-01", "é“¶åæ—¥åˆ©ETFï¼ˆ511880ï¼‰", "ä¹°å…¥", 100.769, 500, 50384.5, "äººæ°‘å¸", "å›½é‡‘1030", 93],
                ["2025-07-30", "æ–°åä¿é™©ï¼ˆ01336ï¼‰", "å–å‡º", 52.0, 900, 46800.0, "äººæ°‘å¸", "å›½é‡‘1030", 16],
                ["2025-07-23", "é“¶åæ—¥åˆ©ETFï¼ˆ511880ï¼‰", "å–å‡º", 100.726, 10000, 1007260.0, "äººæ°‘å¸", "å›½é‡‘1030", 93],
                ["2025-07-23", "é“¶åæ—¥åˆ©ETFï¼ˆ511880ï¼‰", "å–å‡º", 100.726, 3000, 302178.0, "äººæ°‘å¸", "é“¶æ²³6811", 93],
                ["2025-07-23", "é“¶åæ—¥åˆ©ETFï¼ˆ511880ï¼‰", "ä¹°å…¥", 100.719, 3600, 362588.4, "äººæ°‘å¸", "å›½é‡‘7948", 93]
            ],
            dividend_array: [
                ["2025-06-30", "ä¸­å›½å¹³å®‰ï¼ˆ601318ï¼‰", 3888.0, "å›½é‡‘1030", 2],
                ["2025-06-26", "å¤äº•è´¡Bï¼ˆ200596ï¼‰", 6547.0, "é“¶æ²³6811", 48],
                ["2025-06-26", "è´µå·èŒ…å°ï¼ˆ600519ï¼‰", 44277.0, "å›½é‡‘7948", 26],
                ["2025-06-26", "è´µå·èŒ…å°ï¼ˆ600519ï¼‰", 8302.0, "é“¶æ²³6586", 26],
                ["2025-06-26", "è´µå·èŒ…å°ï¼ˆ600519ï¼‰", 141132.0, "é“¶æ²³6811", 26]
            ],
            subscription_array: [
                ["2025-07-07", "åç”µæ–°èƒ½", "è‚¡ç¥¨", 500, 2210.0, 138.9937106918239, "å›½é‡‘1030"],
                ["2025-07-07", "åç”µæ–°èƒ½", "è‚¡ç¥¨", 5000, 24975.0, 157.0754716981132, "å›½é‡‘7948"],
                ["2024-12-19", "å›½è´§èˆª", "è‚¡ç¥¨", 500, 4085.0, 355.2173913043478, "åæ³°8120"],
                ["2024-11-18", "é¢†ç›Šè½¬å€º", "å¯è½¬å€º", 10, 235.16, 23.516, "åæ³°3479"],
                ["2024-11-07", "å˜‰ç›Šè½¬å€º", "å¯è½¬å€º", 10, 190.45, 19.045, "å›½é‡‘1030"]
            ],
            modified_time: "2025-08-15 16:10:57"
        };

        // åˆå§‹åŒ–æ‰€æœ‰å›¾è¡¨
        document.addEventListener('DOMContentLoaded', function() {
            // æŠ•èµ„ç»„åˆæŠ•èµ„ç»„åˆåˆ†å¸ƒå›¾
            const portfolioChart = echarts.init(document.getElementById('portfolioDistributionChart'));
            portfolioChart.setOption({
                tooltip: {
                    trigger: 'item',
                    formatter: '{b}: {c}ä¸‡ ({d}%)'
                },
                legend: {
                    orient: 'vertical',
                    right: 10,
                    top: 'center',
                    textStyle: {
                        fontSize: 12
                    }
                },
                series: [{
                    name: 'æŠ•èµ„ç»„åˆæŠ•èµ„ç»„åˆåˆ†å¸ƒ',
                    type: 'pie',
                    radius: ['40%', '70%'],
                    center: ['40%', '50%'],
                    avoidLabelOverlap: false,
                    itemStyle: {
                        borderRadius: 10,
                        borderColor: '#fff',
                        borderWidth: 2
                    },
                    label: {
                        show: false,
                        position: 'center'
                    },
                    emphasis: {
                        label: {
                            show: true,
                            fontSize: 18,
                            fontWeight: 'bold'
                        }
                    },
                    labelLine: {
                        show: false
                    },
                    data: [
                        { value: (portfolioData.portfolio_value_array[0]/10000).toFixed(2), name: 'äººæ°‘å¸', itemStyle: { color: '#4c6ef5' } },
                        { value: (portfolioData.portfolio_value_array[1]/10000).toFixed(2), name: 'æ¸¯å…ƒ', itemStyle: { color: '#ff922b' } },
                        { value: (portfolioData.portfolio_value_array[2]/10000).toFixed(2), name: 'ç¾å…ƒ', itemStyle: { color: '#40c057' } }
                    ]
                }]
            });

            // æŒä»“è‚¡ç¥¨å¸‚å€¼å æ¯”
            const holdingChart = echarts.init(document.getElementById('holdingChart'));
            holdingChart.setOption({
                tooltip: {
                    trigger: 'item',
                    formatter: '{b}: {c}ä¸‡ ({d}%)'
                },
                legend: {
                    bottom: 10,
                    left: 'center',
                    textStyle: {
                        fontSize: 11
                    }
                },
                series: [{
                    name: 'æŒä»“å¸‚å€¼å æ¯”',
                    type: 'pie',
                    radius: '65%',
                    center: ['50%', '45%'],
                    itemStyle: {
                        borderRadius: 5,
                        borderColor: '#fff',
                        borderWidth: 2
                    },
                    label: {
                        formatter: '{b|{b}}\n{c}ä¸‡',
                        rich: {
                            b: {
                                fontSize: 12,
                                lineHeight: 20
                            }
                        }
                    },
                    emphasis: {
                        itemStyle: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    },
                    data: [
                        { value: (18445234.08/10000).toFixed(2), name: 'è…¾è®¯æ§è‚¡ï¼ˆ00700ï¼‰', itemStyle: { color: '#4c6ef5' } },
                        { value: (9954560/10000).toFixed(2), name: 'è´µå·èŒ…å°ï¼ˆ600519ï¼‰', itemStyle: { color: '#ff922b' } },
                        { value: (3175231.5/10000).toFixed(2), name: 'é“¶åæ—¥åˆ©ETFï¼ˆ511880ï¼‰', itemStyle: { color: '#40c057' } },
                        { value: (652828/10000).toFixed(2), name: 'åˆ†ä¼—ä¼ åª’ï¼ˆ002027ï¼‰', itemStyle: { color: '#fab005' } },
                        { value: (305412.656/10000).toFixed(2), name: 'å¤§å…¨æ–°èƒ½æºï¼ˆDQï¼‰', itemStyle: { color: '#e64980' } },
                        { value: (138.75), name: 'å…¶ä»–æŒä»“', itemStyle: { color: '#adb5bd' } }
                    ]
                }]
            });

            // å¸‚åœºåˆ†å¸ƒå›¾
            const marketChart = echarts.init(document.getElementById('marketDistributionChart'));
            marketChart.setOption({
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: ['æ¸¯è‚¡', 'æ²ªå¸‚Aè‚¡', 'æ·±å¸‚Aè‚¡', 'ç¾è‚¡', 'æ·±å¸‚Bè‚¡'],
                    axisLabel: {
                        interval: 0,
                        rotate: 0
                    }
                },
                yAxis: {
                    type: 'value',
                    name: 'å¸‚å€¼ï¼ˆä¸‡å…ƒï¼‰'
                },
                series: [{
                    name: 'å¸‚å€¼',
                    type: 'bar',
                    barWidth: '60%',
                    itemStyle: {
                        color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                            { offset: 0, color: '#4c6ef5' },
                            { offset: 1, color: '#3b5bdb' }
                        ]),
                        borderRadius: [5, 5, 0, 0]
                    },
                    data: [
                        portfolioData.market_value_array[0]/10000,
                        portfolioData.market_value_array[1]/10000,
                        portfolioData.market_value_array[2]/10000,
                        portfolioData.market_value_array[3]/10000,
                        portfolioData.market_value_array[4]/10000
                    ]
                }]
            });

            // æŒä»“è‚¡ç¥¨å¸‚å€¼å›¾
            const stockChart = echarts.init(document.getElementById('stockValueChart'));
            stockChart.setOption({
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    },
                    formatter: function(params) {
                        return `${params[0].name}<br/>å¸‚å€¼: ${params[0].value}ä¸‡å…ƒ<br/>å æ¯”: ${params[0].data[2]}`;
                    }
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'value',
                    name: 'å¸‚å€¼ï¼ˆä¸‡å…ƒï¼‰'
                },
                yAxis: {
                    type: 'category',
                    data: portfolioData.holding_stock_array.map(item => item[0]),
                    axisLabel: {
                        interval: 0,
                        fontSize: 11
                    }
                },
                series: [{
                    name: 'å¸‚å€¼',
                    type: 'bar',
                    barWidth: '60%',
                    itemStyle: {
                        color: new echarts.graphic.LinearGradient(1, 0, 0, 0, [
                            { offset: 0, color: '#4c6ef5' },
                            { offset: 1, color: '#748ffc' }
                        ]),
                        borderRadius: [0, 5, 5, 0]
                    },
                    data: portfolioData.holding_stock_array.map(item => (item[5]/10000).toFixed(2))
                }]
            });

            // å¡«å……åˆ†çº¢è¡¨æ ¼
            const dividendTableBody = document.getElementById('dividendTableBody');
            portfolioData.dividend_array.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item[0]}</td>
                    <td>${item[1]}</td>
                    <td class="dividend-cell">${item[2].toLocaleString()}</td>
                    <td>${item[3]}</td>
                `;
                dividendTableBody.appendChild(row);
            });

            // å¡«å……äº¤æ˜“è¡¨æ ¼
            const tradeTableBody = document.getElementById('tradeTableBody');
            portfolioData.trade_array.forEach(item => {
                const row = document.createElement('tr');
                const operationClass = item[2] === 'ä¹°å…¥' ? 'buy-cell' : 'sell-cell';
                row.innerHTML = `
                    <td>${item[0]}</td>
                    <td>${item[1]}</td>
                    <td class="${operationClass}">${item[2]}</td>
                    <td>${item[3]}</td>
                    <td>${item[4].toLocaleString()}</td>
                    <td>${item[5].toLocaleString()}</td>
                `;
                tradeTableBody.appendChild(row);
            });

            // å“åº”å¼è°ƒæ•´
            window.addEventListener('resize', function() {
                portfolioChart.resize();
                holdingChart.resize();
                marketChart.resize();
                stockChart.resize();
            });
        });
    </script>
</body>
</html>
{% endblock %}